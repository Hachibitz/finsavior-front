<div class="overlay" *ngIf="loading">
  <div class="custom-loader"></div>
</div>

<app-header-bar></app-header-bar>

<div class="box"  [class.dark-mode]="darkMode">
    <mat-card>
      <mat-card-title>Cadastro</mat-card-title>
      <mat-card-content>
        <form [formGroup]="registerForm" (ngSubmit)="signUp()">
          <mat-form-field appearance="fill">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" placeholder="Email">
            <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
              Email é obrigatório
            </mat-error>
            <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
              Email inválido
            </mat-error>
          </mat-form-field>
  
          <mat-form-field appearance="fill">
            <mat-label>Usuário</mat-label>
            <input matInput formControlName="username" placeholder="Usuário">
            <mat-error *ngIf="registerForm.get('username')?.hasError('required')">
              Usuário é obrigatório
            </mat-error>
          </mat-form-field>
  
          <mat-form-field appearance="fill">
            <mat-label>Nome</mat-label>
            <input matInput formControlName="name" placeholder="Nome">
            <mat-error *ngIf="registerForm.get('name')?.hasError('required')">
              Nome é obrigatório
            </mat-error>
          </mat-form-field>
  
          <mat-form-field appearance="fill">
            <mat-label>Sobrenome</mat-label>
            <input matInput formControlName="lastname" placeholder="Sobrenome">
            <mat-error *ngIf="registerForm.get('lastname')?.hasError('required')">
              Sobrenome é obrigatório
            </mat-error>
          </mat-form-field>
  
          <mat-form-field appearance="fill">
            <mat-label>Senha</mat-label>
            <input matInput type="password" formControlName="password" placeholder="Senha" (input)="checkPassword()">
            <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
              Senha é obrigatória
            </mat-error>
            <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">
              A senha deve ter pelo menos 6 caracteres
            </mat-error>
          </mat-form-field>
  
          <div class="password-requirements">
            <p [ngStyle]="{'color': passwordCriteria.length ? 'blue' : 'red'}">Pelo menos 8 caracteres</p>
            <p [ngStyle]="{'color': passwordCriteria.upper ? 'blue' : 'red'}">Pelo menos 1 letra maiúscula</p>
            <p [ngStyle]="{'color': passwordCriteria.lower ? 'blue' : 'red'}">Pelo menos 1 letra minúscula</p>
            <p [ngStyle]="{'color': passwordCriteria.number ? 'blue' : 'red'}">Pelo menos 1 número</p>
            <p [ngStyle]="{'color': passwordCriteria.special ? 'blue' : 'red'}">Pelo menos 1 caractere especial</p>
          </div>
  
          <mat-form-field appearance="fill">
            <mat-label>Confirme a senha</mat-label>
            <input matInput type="password" formControlName="passwordConfirmation" placeholder="Repetir senha">
            <mat-error *ngIf="registerForm.get('passwordConfirmation')?.hasError('required')">
              Confirmação de senha é obrigatória
            </mat-error>
            <mat-error *ngIf="registerForm.hasError('passwordMismatch')">
              As senhas não conferem
            </mat-error>
          </mat-form-field>
  
          <mat-checkbox formControlName="agreement">
            Declaro que li e aceito os 
            <a href="javascript:void(0)" (click)="openTermsDialog()">Termos e Condições</a> e 
            <a href="javascript:void(0)" (click)="openPrivacyDialog()">Política de Privacidade</a>
          </mat-checkbox>
          <mat-error *ngIf="registerForm.get('agreement')?.hasError('required')">
            Você deve aceitar os termos e condições
          </mat-error>
  
          <div class="button-container">
            <button mat-raised-button color="primary" type="submit" [disabled]="registerForm.invalid">Cadastrar</button>
          </div>
  
          <br>
          <label class="register-link">Já tem uma conta? <a href="javascript:void(0)" (click)="redirectToLogin()">Login</a></label>
        </form>
      </mat-card-content>
    </mat-card>
</div>
